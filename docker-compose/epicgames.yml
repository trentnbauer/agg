version: '3'
services:
  app:
    image: ghcr.io/claabs/epicgames-freegames-node:bullseye-slim@sha256:7a86071da4385c1ea01f496dfdcb161425861d8b3e017b0f8d2b961eab22f3b9
    ports:
      - ${WEBPORT:-3000}:3000/udp
      - ${WEBPORT:-3000}:3000/tcp
    restart: unless-stopped
    volumes:
      - config:/usr/app/config
    environment:
      - TZ=${TZ:-Australia/Melbourne}
      - EMAIL=${RECIPIENT} #Email this person when a new free game is released
      - RUN_ON_STARTUP=${RUN_ON_STARTUP:-true}
      - BASE_URL=https://${SUBDOMAIN}${DOMAIN}
      - SMTP_HOST=${SMTP_HOST:-smtp.gmail.com}
      - SMTP_PORT=${SMTP_PORT:-587}
      - EMAIL_SENDER_ADDRESS=${SMTP_FROM} #Emails will be sent from this address
      - EMAIL_SENDER_NAME=${SMTP_SUBJECT:-Epic Games Free Games}
      #- EMAIL_RECIPIENT_ADDRESS=${RECIPIENT} #Email this person when a new free game is released
      - SMTP_SECURE=${SMTP_SECURE:-false}
      - SMTP_USERNAME=${SMTP_USERNAME}
      - SMTP_PASSWORD=${SMTP_PASSWORD}
      - LOCAL_TUNNEL=${LOCAL_TUNNEL:-false}
    mem_limit: 2G
    labels:
      - cloudflare.tunnel.enable=true
      - cloudflare.tunnel.hostname=${SUBDOMAIN}${DOMAIN}
      - cloudflare.tunnel.service=http://${HOSTNAME:-localhost}:${WEBPORT:-3000}
      - cloudflare.tunnel.access.policy=${CFPOLICY:-bypass}
      - cloudflare.tunnel.zonename=${DOMAIN}
    logging:
      driver: "json-file"
      options:
        max-size: "5m"
        max-file: "3"

volumes:
  config:

#MINIMUM ENV
#RECIPIENT=
#FROM_SMTP=
#SMTP_USERNAME=
#SMTP_PASSWORD=
#SUBDOMAIN=
#DOMAIN=
#HOSTNAME=


#### To register multiple accounts, you will need to manually edit the "accounts" section of the JSON file per https://github.com/claabs/epicgames-freegames-node?tab=readme-ov-file#json-configuration


















